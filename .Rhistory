pop.graph1 <- ggplot(mlgs_by_date[mlgs_by_date$date < "2011-01-01",],
aes(x = mlg2, y = count)) +
facet_grid(type ~ date, scales = "free") +
geom_bar(stat = "identity", width = 0.5) +
theme_bw() +
removeGrid() +
scale_x_discrete(expand = c(0.02,0.02)) +
theme(axis.text.x = element_blank()) +
xlab(label = "MLG") +
ylab(label = "Count") +
theme(aspect.ratio = 1)
pop.graph2 <- ggplot(mlgs_by_date[mlgs_by_date$date > "2011-01-01" &
mlgs_by_date$date < "2012-01-01", ],
aes(x = mlg2, y = count)) +
facet_grid(type ~ date, scales = "free") +
geom_bar(stat = "identity", width = 0.5) +
theme_bw() +
removeGrid() +
scale_x_discrete(expand = c(0.02,0.02)) +
theme(axis.text.x = element_blank()) +
xlab(label = "MLG") +
ylab(label = "Count") +
theme(aspect.ratio = 1)
pop.graph3 <- ggplot(mlgs_by_date[mlgs_by_date$date > "2012-01-01", ],
aes(x = mlg2, y = count)) +
facet_grid(type ~ date, scales = "free") +
geom_bar(stat = "identity", width = 0.5) +
theme_bw() +
removeGrid() +
scale_x_discrete(expand = c(0.02,0.02)) +
theme(axis.text.x = element_blank()) +
xlab(label = "MLG") +
ylab(label = "Count") +
theme(aspect.ratio = 1)
ggarrange(pop.graph1, pop.graph2, pop.graph3, ncol = 1, nrow = 3)
grid.arrange(pop.graph1, pop.graph2, pop.graph3)
#Second, create the graph (in 2 pieces)
pop.graph1 <- ggplot(mlgs_by_date[mlgs_by_date$date < "2011-01-01",],
aes(x = mlg2, y = count)) +
facet_grid(type ~ date, scales = "free") +
geom_bar(stat = "identity", width = 0.5) +
theme_bw() +
removeGrid() +
scale_x_discrete(expand = c(0.02,0.02)) +
theme(axis.text.x = element_blank(),
axis.title.x = element_blank()) +
ylab(label = "Count") +
theme(aspect.ratio = 1)
pop.graph2 <- ggplot(mlgs_by_date[mlgs_by_date$date > "2011-01-01" &
mlgs_by_date$date < "2012-01-01", ],
aes(x = mlg2, y = count)) +
facet_grid(type ~ date, scales = "free") +
geom_bar(stat = "identity", width = 0.5) +
theme_bw() +
removeGrid() +
scale_x_discrete(expand = c(0.02,0.02)) +
theme(axis.text.x = element_blank(),
axis.title.x = element_blank()) +
ylab(label = "Count") +
theme(aspect.ratio = 1)
pop.graph3 <- ggplot(mlgs_by_date[mlgs_by_date$date > "2012-01-01", ],
aes(x = mlg2, y = count)) +
facet_grid(type ~ date, scales = "free") +
geom_bar(stat = "identity", width = 0.5) +
theme_bw() +
removeGrid() +
scale_x_discrete(expand = c(0.02,0.02)) +
theme(axis.text.x = element_blank()) +
xlab(label = "MLG") +
ylab(label = "Count") +
theme(aspect.ratio = 1)
grid.arrange(pop.graph1, pop.graph2, pop.graph3)
#Second, create the graph (in 2 pieces)
pop.graph1 <- ggplot(mlgs_by_date[mlgs_by_date$date < "2011-01-01",],
aes(x = mlg2, y = count)) +
facet_grid(type ~ date, scales = "free") +
geom_bar(stat = "identity") +
theme_bw() +
removeGrid() +
scale_x_discrete(expand = c(0.02,0.02)) +
theme(axis.text.x = element_blank(),
axis.title.x = element_blank()) +
ylab(label = "Count") +
theme(aspect.ratio = 1)
pop.graph2 <- ggplot(mlgs_by_date[mlgs_by_date$date > "2011-01-01" &
mlgs_by_date$date < "2012-01-01", ],
aes(x = mlg2, y = count)) +
facet_grid(type ~ date, scales = "free") +
geom_bar(stat = "identity") +
theme_bw() +
removeGrid() +
scale_x_discrete(expand = c(0.02,0.02)) +
theme(axis.text.x = element_blank(),
axis.title.x = element_blank()) +
ylab(label = "Count") +
theme(aspect.ratio = 1)
pop.graph3 <- ggplot(mlgs_by_date[mlgs_by_date$date > "2012-01-01", ],
aes(x = mlg2, y = count)) +
facet_grid(type ~ date, scales = "free") +
geom_bar(stat = "identity") +
theme_bw() +
removeGrid() +
scale_x_discrete(expand = c(0.02,0.02)) +
theme(axis.text.x = element_blank()) +
xlab(label = "MLG") +
ylab(label = "Count") +
theme(aspect.ratio = 1)
grid.arrange(pop.graph1, pop.graph2, pop.graph3)
pop.graph1
#Second, create the graph (in 2 pieces)
pop.graph1 <- ggplot(mlgs_by_date[mlgs_by_date$date < "2011-09-01",],
aes(x = mlg2, y = count)) +
facet_grid(type ~ date, scales = "free") +
geom_bar(stat = "identity", width = 0.8) +
theme_bw() +
removeGrid() +
scale_x_discrete(expand = c(0.02,0.02)) +
theme(axis.text.x = element_blank(),
axis.title.x = element_blank()) +
ylab(label = "Count") +
theme(aspect.ratio = 1)
pop.graph2 <- ggplot(mlgs_by_date[mlgs_by_date$date > "2011-01-01" &
mlgs_by_date$date < "2012-01-01", ],
aes(x = mlg2, y = count)) +
facet_grid(type ~ date, scales = "free") +
geom_bar(stat = "identity", width = 0.8) +
theme_bw() +
removeGrid() +
scale_x_discrete(expand = c(0.02,0.02)) +
theme(axis.text.x = element_blank(),
axis.title.x = element_blank()) +
ylab(label = "Count") +
theme(aspect.ratio = 1)
grid.arrange(pop.graph1, pop.graph2)
pop.graph2 <- ggplot(mlgs_by_date[mlgs_by_date$date > "2011-09-01", ],
aes(x = mlg2, y = count)) +
facet_grid(type ~ date, scales = "free") +
geom_bar(stat = "identity", width = 0.8) +
theme_bw() +
removeGrid() +
scale_x_discrete(expand = c(0.02,0.02)) +
theme(axis.text.x = element_blank(),
axis.title.x = element_blank()) +
ylab(label = "Count") +
theme(aspect.ratio = 1)
grid.arrange(pop.graph1, pop.graph2)
gA <- ggplotGrob(pop.graph1)
gB <- ggplotGrob(pop.graph2)
grid::grid.newpage()
grid::grid.draw(rbind(gA, gB))
grid.draw(rbind(gA, gB, size="first"))
install.packages("cowplot")
library(cowplot)
plot_grid(pop.graph1, pop.graph2, align = "v")
plot_grid(pop.graph1, pop.graph2, align = "v", nrow = 2, axis = "l")
plot_grid(pop.graph1, pop.graph2, align = "h", nrow = 2, axis = "l")
plot_grid(pop.graph1, pop.graph2, align = "h", nrow = 2, axis = "r")
plot_grid(pop.graph1, pop.graph2, align = "h", nrow = 2, axis = "t")
plot_grid(pop.graph1, pop.graph2, align = "v", nrow = 2, axis = "t")
plot_grid(pop.graph1, pop.graph2, align = "v", nrow = 2, axis = "l")
plot_grid(pop.graph1, pop.graph2, align = "v", nrow = 2, axis = "l")
plot_grid(pop.graph1, pop.graph2, align = "v", nrow = 2, axis = "tl")
pop.graph2 <- ggplot(mlgs_by_date[mlgs_by_date$date > "2011-09-01", ],
aes(x = mlg2, y = count)) +
facet_grid(type ~ date, scales = "free") +
geom_bar(stat = "identity", width = 0.8) +
theme_bw() +
removeGrid() +
scale_x_discrete(expand = c(0.02,0.02)) +
theme(axis.text.x = element_blank(),
axis.title.x = element_blank()) +
ylab(label = "Count") +
xlab(label = "MLG")
pop.graph2 <- ggplot(mlgs_by_date[mlgs_by_date$date > "2011-09-01", ],
aes(x = mlg2, y = count)) +
facet_grid(type ~ date, scales = "free") +
geom_bar(stat = "identity", width = 0.8) +
theme_bw() +
removeGrid() +
scale_x_discrete(expand = c(0.02,0.02)) +
theme(axis.text.x = element_blank(),
axis.title.x = element_blank()) +
ylab(label = "Count") +
xlab(label = "MLG")
library(ggplot2)
library(ggExtra)
library(ggpubr)
library(cowplot)
#Second, create the graph (in 2 pieces)
pop.graph1 <- ggplot(mlgs_by_date[mlgs_by_date$date < "2011-09-01",],
aes(x = mlg2, y = count)) +
facet_grid(type ~ date, scales = "free") +
geom_bar(stat = "identity", width = 0.8) +
theme_bw() +
removeGrid() +
scale_x_discrete(expand = c(0.02,0.02)) +
theme(axis.text.x = element_blank(),
axis.title.x = element_blank()) +
ylab(label = "Count") +
theme(aspect.ratio = 1)
pop.graph2 <- ggplot(mlgs_by_date[mlgs_by_date$date > "2011-09-01", ],
aes(x = mlg2, y = count)) +
facet_grid(type ~ date, scales = "free") +
geom_bar(stat = "identity", width = 0.8) +
theme_bw() +
removeGrid() +
scale_x_discrete(expand = c(0.02,0.02)) +
theme(axis.text.x = element_blank(),
axis.title.x = element_blank()) +
ylab(label = "Count") +
xlab(label = "MLG")
pop.graph2 <- ggplot(mlgs_by_date[mlgs_by_date$date > "2011-09-01", ],
aes(x = mlg2, y = count)) +
facet_grid(type ~ date, scales = "free") +
geom_bar(stat = "identity", width = 0.8) +
theme_bw() +
removeGrid() +
scale_x_discrete(expand = c(0.02,0.02)) +
theme(axis.text.x = element_blank(),
axis.title.x = element_blank()) +
ylab(label = "Count") +
xlab(label = "MLG") +
theme(aspect.ratio = 1)
plot_grid(pop.graph1, pop.graph2, align = "v", nrow = 2, axis = "tl")
pop.graph2 <- ggplot(mlgs_by_date[mlgs_by_date$date > "2011-09-01", ],
aes(x = mlg2, y = count)) +
facet_grid(type ~ date, scales = "free") +
geom_bar(stat = "identity", width = 0.8) +
theme_bw() +
removeGrid() +
scale_x_discrete(expand = c(0.02,0.02)) +
theme(axis.text.x = element_blank(),
axis.title.x = element_blank()) +
ylab(label = "Count") +
xlab(label = "MLG") +
theme(aspect.ratio = 1)
plot_grid(pop.graph1, pop.graph2, align = "v", nrow = 2, axis = "tl")
pop.graph2 <- ggplot(mlgs_by_date[mlgs_by_date$date > "2011-09-01", ],
aes(x = mlg2, y = count)) +
facet_grid(type ~ date, scales = "free") +
geom_bar(stat = "identity", width = 0.8) +
theme_bw() +
removeGrid() +
scale_x_discrete(expand = c(0.02,0.02)) +
theme(axis.text.x = element_blank(),) +
ylab(label = "Count") +
xlab(label = "MLG") +
theme(aspect.ratio = 1)
plot_grid(pop.graph1, pop.graph2, align = "v", nrow = 2, axis = "tl")
ggsave("Rand_vs_Inf.pdf", plot_grid(pop.graph1, pop.graph2, nrow = 2)
)
save_plot("Rand_vs_Inf.pdf", plot_grid(pop.graph1, pop.graph2, nrow = 2))
#Second, create the graph (in 2 pieces)
pop.graph1 <- ggplot(mlgs_by_date[mlgs_by_date$date < "2011-09-01",],
aes(x = mlg2, y = count)) +
facet_grid(type ~ date, scales = "free") +
geom_bar(stat = "identity", width = 0.8) +
scale_x_discrete(expand = c(0.02,0.02)) +
theme(axis.text.x = element_blank(),
axis.title.x = element_blank()) +
ylab(label = "Count") +
theme(aspect.ratio = 1)
pop.graph2 <- ggplot(mlgs_by_date[mlgs_by_date$date > "2011-09-01", ],
aes(x = mlg2, y = count)) +
facet_grid(type ~ date, scales = "free") +
geom_bar(stat = "identity", width = 0.8) +
scale_x_discrete(expand = c(0.02,0.02)) +
theme(axis.text.x = element_blank(),) +
ylab(label = "Count") +
xlab(label = "MLG") +
theme(aspect.ratio = 1)
save_plot("Rand_vs_Inf.pdf", plot_grid(pop.graph1, pop.graph2, nrow = 2))
ggsave("test.pdf", pop.graph2)
#Second, create the graph
pop.graph <- ggplot(mlgs_by_date,
aes(x = mlg2, y = count)) +
facet_grid(type ~ date, scales = "free") +
geom_bar(stat = "identity", width = 0.8) +
theme_bw() +
removeGrid() +
scale_x_discrete(expand = c(0.02,0.02)) +
theme(axis.text.x = element_blank(),
axis.title.x = element_blank()) +
ylab(label = "Count") +
theme(aspect.ratio = 1)
ggsave("test.pdf", pop.graph)
#Second, create the graph
pop.graph <- ggplot(mlgs_by_date,
aes(x = mlg2, y = count)) +
facet_grid(type ~ date, scales = "free") +
geom_bar(stat = "identity", width = 0.8) +
theme_bw() +
removeGrid() +
scale_x_discrete(expand = c(0.02,0.02)) +
theme(axis.text.x = element_blank(),
axis.title.x = element_blank(),
axis.ticks.x = element_blank()) +
ylab(label = "Count") +
theme(aspect.ratio = 1)
ggsave("test.pdf", pop.graph)
ggsave("test.pdf", pop.graph, width = 10, units = "in", dpi = 600)
g
#Second, create the graph
pop.graph <- ggplot(mlgs_by_date,
aes(x = mlg2, y = count)) +
facet_grid(type ~ date, scales = "free") +
geom_bar(stat = "identity", width = 0.8) +
theme_bw() +
removeGrid() +
scale_x_discrete(expand = c(0.02,0.02)) +
theme(axis.text.x = element_blank(),
axis.title.x = element_blank(),
axis.ticks.x = element_blank()) +
ylab(label = "Count") +
theme(aspect.ratio = 1) +
axis_flip()
#Second, create the graph
pop.graph <- ggplot(mlgs_by_date,
aes(x = mlg2, y = count)) +
facet_grid(type ~ date, scales = "free") +
geom_bar(stat = "identity", width = 0.8) +
theme_bw() +
removeGrid() +
scale_x_discrete(expand = c(0.02,0.02)) +
theme(axis.text.x = element_blank(),
axis.title.x = element_blank(),
axis.ticks.x = element_blank()) +
ylab(label = "Count") +
theme(aspect.ratio = 1) +
coord_flip()
pop.graph
#Second, create the graph
pop.graph <- ggplot(mlgs_by_date,
aes(x = mlg2, y = count)) +
facet_grid(type ~ date, scales = "free") +
geom_bar(stat = "identity", width = 0.8) +
theme_bw() +
removeGrid() +
scale_x_discrete(expand = c(0.02,0.02)) +
theme(axis.text.x = element_blank(),
axis.title.x = element_blank(),
axis.ticks.x = element_blank()) +
ylab(label = "Count") +
theme(aspect.ratio = 1) +
pop.graph
ggsave("test.pdf", pop.graph, width = 10, units = "in", dpi = 600)
#Second, create the graph
pop.graph <- ggplot(mlgs_by_date,
aes(x = mlg2, y = count)) +
facet_grid(type ~ date, scales = "free") +
geom_bar(stat = "identity", width = 0.8) +
theme_bw() +
removeGrid() +
scale_x_discrete(expand = c(0.02,0.02)) +
theme(axis.text.x = element_blank(),
axis.title.x = element_blank(),
axis.ticks.x = element_blank()) +
ylab(label = "Count") +
theme(aspect.ratio = 1)
pop.graph
ggsave("test.pdf", pop.graph, width = 10, units = "in", dpi = 600)
#Second, create the graph
pop.graph <- ggplot(mlgs_by_date,
aes(x = mlg2, y = count)) +
facet_grid(type ~ date, scales = "free") +
geom_bar(stat = "identity", width = 0.8) +
theme_bw() +
removeGrid() +
scale_x_discrete(expand = c(0.02,0.02)) +
theme(axis.text.x = element_blank(),
axis.title.x = element_blank(),
axis.ticks.x = element_blank()) +
ylab(label = "Count") +
theme(aspect.ratio = 1) +
coord_flip()
pop.graph
ggsave("test.pdf", pop.graph, width = 10, units = "in", dpi = 600)
#Second, create the graph
pop.graph <- ggplot(mlgs_by_date,
aes(x = mlg2, y = count)) +
facet_grid(date~type, scales = "free") +
geom_bar(stat = "identity", width = 0.8) +
theme_bw() +
removeGrid() +
scale_x_discrete(expand = c(0.02,0.02)) +
theme(axis.text.x = element_blank(),
axis.title.x = element_blank(),
axis.ticks.x = element_blank()) +
ylab(label = "Count") +
theme(aspect.ratio = 1) +
coord_flip()
pop.graph
ggsave("test.pdf", pop.graph, width = 10, units = "in", dpi = 600)
#Second, create the graph
pop.graph <- ggplot(mlgs_by_date,
aes(x = mlg2, y = count)) +
facet_grid(date~type, scales = "free") +
geom_bar(stat = "identity", width = 0.8) +
theme_bw() +
removeGrid() +
scale_x_discrete(expand = c(0.02,0.02)) +
theme(axis.text.y = element_blank(),
axis.title.y = element_blank(),
axis.ticks.y = element_blank()) +
ylab(label = "Count") +
theme(aspect.ratio = 1) +
coord_flip()
pop.graph
ggsave("test.pdf", pop.graph, width = 10, units = "in", dpi = 600)
#Second, create the graph
pop.graph <- ggplot(mlgs_by_date,
aes(x = mlg2, y = count)) +
facet_grid(date~type, scales = "free") +
geom_bar(stat = "identity", width = 0.8) +
theme_bw() +
removeGrid() +
scale_x_discrete(expand = c(0.02,0.02)) +
theme(axis.text.y = element_blank(),
axis.title.y = element_blank(),
axis.ticks.y = element_blank()) +
ylab(label = "Count") +
theme(aspect.ratio = 1) +
coord_flip()
pop.graph
ggsave("test.pdf", pop.graph, height = 10, width = 4, units = "in", dpi = 600)
#Second, create the graph
pop.graph <- ggplot(mlgs_by_date,
aes(x = mlg2, y = count)) +
facet_grid(date~type, scales = "free") +
geom_bar(stat = "identity", width = 0.8) +
theme_bw() +
removeGrid() +
scale_x_discrete(expand = c(0.02,0.02)) +
theme(axis.text.y = element_blank(),
axis.title.y = element_blank(),
axis.ticks.y = element_blank()) +
ylab(label = "Count") +
xlab(label = "MLG")
#Second, create the graph
pop.graph <- ggplot(mlgs_by_date,
aes(x = mlg2, y = count)) +
facet_grid(date~type, scales = "free") +
geom_bar(stat = "identity", width = 0.8) +
theme_bw() +
removeGrid() +
scale_x_discrete(expand = c(0.02,0.02)) +
theme(axis.text.y = element_blank(),
axis.title.y = element_blank(),
axis.ticks.y = element_blank()) +
ylab(label = "Count") +
xlab(label = "MLG") +
theme(aspect.ratio = 1) +
coord_flip()
ggsave("test.pdf", pop.graph, height = 10, width = 4, units = "in", dpi = 600)
#Second, create the graph
pop.graph <- ggplot(mlgs_by_date,
aes(x = mlg2, y = count)) +
facet_grid(date~type, scales = "free") +
geom_bar(stat = "identity", width = 0.8) +
theme_bw() +
removeGrid() +
scale_x_discrete(expand = c(0.02,0.02)) +
theme(axis.text.y = element_blank(),
axis.ticks.y = element_blank()) +
ylab(label = "Count") +
xlab(label = "MLG") +
theme(aspect.ratio = 1) +
coord_flip()
pop.graph
ggsave("test.pdf", pop.graph, height = 10, width = 4, units = "in", dpi = 600)
#Do a Fisher's exact test to check whether infected and random samples differ at each date
dates <- unique(counts$date)
pop.fish <- data.frame(date = dates, p_value = 0)
for(i in 1:length(dates)){
tmp <- counts[counts$date == dates[i],]
tmp <- dcast(tmp, mlg ~ type)
tmp <- tmp[tmp$Infected != 0 | tmp$Random !=0, ]
fish <- fisher.test(as.matrix(tmp[, 2:3]), workspace = 1e+09)
pop.fish[i, "p_value"] <- fish$p.value
}
library(plyr)
library(reshape2)
for(i in 1:length(dates)){
tmp <- counts[counts$date == dates[i],]
tmp <- dcast(tmp, mlg ~ type)
tmp <- tmp[tmp$Infected != 0 | tmp$Random !=0, ]
fish <- fisher.test(as.matrix(tmp[, 2:3]), workspace = 1e+09)
pop.fish[i, "p_value"] <- fish$p.value
}
View(pop.fish)
pop.fish$p_value[1]
round(pop.fish$p_value[1])
View(pop.fish)
View(pop.fish)
pop.fish
mlgs_by_date[mlgs_by_date == 0] <- NA
#Second, create the graph
pop.graph <- ggplot(mlgs_by_date,
aes(x = mlg2, y = count)) +
facet_grid(date~type, scales = "free") +
geom_bar(stat = "identity", width = 0.8) +
theme_bw() +
removeGrid() +
scale_x_discrete(expand = c(0.02, 0.02)) +
theme(axis.text.y = element_blank(),
axis.ticks.y = element_blank()) +
ylab(label = "Count") +
xlab(label = "MLG") +
theme(aspect.ratio = 1) +
coord_flip()
ggsave("Rand_vs_Inf.pdf", pop.graph, height = 10, width = 4, units = "in", dpi = 600)
ggsave("Rand_vs_Inf.pdf", pop.graph, height = 10, width = 4, units = "in", dpi = 600)
